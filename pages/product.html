<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <script defer src="../static/js/login/auth.js"></script>
    <link rel="stylesheet" href="../static/css/styles.css">
    <script defer src="../init.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora&display=swap" rel="stylesheet">
    <title>Products</title>
</head>
<body>
<!--Navbar-->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark" style="background-color: #00003f !important;">
    <div class="container">
        <a class="navbar-brand" href="./home.html">
            <i class="fas fa-laptop"> KTN</i>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item active">
                    <a class="nav-link" href="./home.html"><i class="fas fa-home"></i> Home </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="./product.html"><i class="fas fa-home"></i> Product </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="./cart.html"><i class="fas fa-home"></i> Cart </a>
                </li>
            </ul>
            <ul class="navbar-nav float-right">
                <li class="nav-item active" style="margin-right: 4%">
                    <a class="btn btn-outline-light" href="./profile.html"><i class="fa fa-user"></i> User </a>
                </li>
                <li class="nav-item active">
                    <a class="btn btn-outline-danger logout" href="#"><i class="fa fa-door"></i> Logout</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<!--Navbar-->

<!--Main body-->
<div class="container">

    <!--Banner-->
    <div class="mt-4 p-5 text-white rounded product-jumbotron" style="background-color: #00003f !important;">
        <h1>Product Gallery</h1>
        <p>Explore new world of products</p>
    </div>
    <!--Banner-->

    <!--Content-->
    <div class="row mt-4">

        <!--Nav pill for product-->
        <div class="col-sm-12 col-md-12 col-lg-6 col-xl-8 d-none d-md-block">
            <div class="d-flex align-items-center text-white rounded product-tab" style="padding: 2%" >
                <div class="nav flex-column nav-pills me-3 rounded" style="background-color: aliceblue !important; margin: 0" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    <button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill" data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home" aria-selected="true">Men's clothing</button>
                    <button class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill" data-bs-target="#v-pills-profile" type="button" role="tab" aria-controls="v-pills-profile" aria-selected="false">Jewelery</button>
                    <button class="nav-link" id="v-pills-messages-tab" data-bs-toggle="pill" data-bs-target="#v-pills-messages" type="button" role="tab" aria-controls="v-pills-messages" aria-selected="false">Electronics</button>
                    <button class="nav-link" id="v-pills-settings-tab" data-bs-toggle="pill" data-bs-target="#v-pills-settings" type="button" role="tab" aria-controls="v-pills-settings" aria-selected="false">Women's clothing</button>
                    <button class="nav-link" id="v-pills-other-tab" data-bs-toggle="pill" data-bs-target="#v-pills-other" type="button" role="tab" aria-controls="v-pills-others" aria-selected="false">Stuffs</button>
                </div>
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
                        <h2>Men's Clothing</h2>
                        <hr class="text-white">
                        As we moved into the 1900s men’s clothing was predominantly utilitarian and rather unimaginative.
                        The long, lean, and athletic silhouette of the late 1890s persisted, and tall, stiff collars characterize the period.
                        Three-piece suits consisting of a sack coat with matching waistcoat and trousers were worn,
                        as were matching coat and waistcoat with contrasting trousers, or matching coat and trousers with contrasting waistcoat.
                        Sounds familiar, right? Trousers were shorter than before, often had “turn-ups” or “cuffs“, and were creased front and back
                        using the newly-invented trouser press.
                    </div>
                    <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
                        <h2>Jewelery</h2>
                        <hr class="text-white">
                        Saxon women wore a long linen garment with a long tunic over it. They also wore mantles.
                        Both men and women used combs made of bone or antler. Viking women spun and wove cloth at home and made the family’s clothes.
                        Women wore a dress-like garment called a shift made of linen or wool. Over it, they wore a dress open at the sides,
                        held with shoulder straps. In cold weather, they wore cloaks or shawls. Clothing was held in place by brooches.
                        Viking women often had their hair plaited or held under a headscarf.
                    </div>
                    <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
                        <h2>Electronics</h2>
                        <hr class="text-white">
                        A gear is a rotating circular machine part having cut teeth or, in the case of a cogwheel or gearwheel, inserted teeth (called cogs),
                        which mesh with another (compatible) toothed part to transmit (convert) torque and speed. The basic principle behind the operation
                        of gears is analogous to the basic principle of levers.[1] A gear may also be known informally as a cog. Geared devices can change
                        the speed, torque, and direction of a power source. Gears of different sizes produce a change in torque, creating a mechanical advantage,
                        through their gear ratio, and thus may be considered a simple machine.
                    </div>
                    <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">
                        <h2>Women's Clothing</h2>
                        <hr class="text-white">
                        The first materials used to make objects for personal adornment were taken from the animal and vegetable world.
                        The material taken from the animal world, in a natural or processed form, constituted the actual adornment,
                        whereas vegetable fibres served as its support. A great variety of shells and pieces of shell were used during the
                        prehistoric age and are still used in certain island and coastal cultures to make necklaces, bracelets, pendants,
                        and headdresses.
                    </div>
                    <div class="tab-pane fade" id="v-pills-other" role="tabpanel" aria-labelledby="v-pills-other-tab">
                        <h2>Stuffs</h2>
                        <hr class="text-white">
                        The first materials used to make objects for personal adornment were taken from the animal and vegetable world.
                        The material taken from the animal world, in a natural or processed form, constituted the actual adornment,
                        whereas vegetable fibres served as its support. A great variety of shells and pieces of shell were used during the
                        prehistoric age and are still used in certain island and coastal cultures to make necklaces, bracelets, pendants,
                        and headdresses.
                    </div>
                </div>
            </div>

        </div>
        <!--Nav pill for product-->

        <!--Product image slide-->
        <div class="col-sm-12 col-lg-6 col-xl-4 d-block d-md-none d-lg-block" >
            <div id="productCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel">
                <div class="carousel-inner bg-white">
                    <div class="carousel-item active" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/81fPKd-2AYL._AC_SL1500_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/71-3HjGNDUL._AC_SY879._SX._UX._SY._UY_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/71li-ujtlUL._AC_UX679_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/71YXzeOuslL._AC_UY879_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/71pWzhdJNwL._AC_UL640_QL65_ML3_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/61sbMiUnoGL._AC_UL640_QL65_ML3_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/51UDEzMJVpL._AC_UL640_QL65_ML3_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/61IBBVJvSDL._AC_SY879_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="https://fakestoreapi.com/img/61U7T1koQqL._AC_SX679_.jpg" class="d-block w-100 carousel-product-image" alt="image">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
        <!--Product image slide-->

    </div>
    <!--Content-->

    <!--Product search-->
    <div class="row">
        <form class="row g-3 align-items-center text-white justify-content-between"
             style="background-color: #00003f !important; margin: 1%; padding-bottom: 1%">
            <div class="col-auto">
                <label for="searchName" class="form-label">Product name</label>
            </div>
            <div class="col-auto">
                <input name="name" value="" type="text" class="form-control" id="searchName">
            </div>
            <div class="col-auto d-none d-md-block">
                <label for="searchCategory" class="form-label">Product category</label>
            </div>
            <div class="col-auto d-none d-md-block">
                <input name="category" value="" type="text" class="form-control" id="searchCategory">
            </div>
            <div class="col-auto d-none d-md-block">
                <label for="searchPriceLower" class="form-label">Price from</label>
            </div>
            <div class="col-auto d-none d-md-block" style="width: 100px">
                <input name="priceLow" min="0" value=1 type="number" class="form-control" id="searchPriceLower">
            </div>
            <div class="col-auto d-none d-md-block">
                <label for="searchPriceUpper" class="form-label"> to </label>
            </div>
            <div class="col-auto d-none d-md-block" style="width: 100px">
                <input name="priceUp" min="1" max="9999" value=9999 type="number" class="form-control" id="searchPriceUpper">
            </div>
            <div class="col-auto d-none d-md-block">
                <label for="pageSize" class="col-form-label">Page size</label>
            </div>
            <div class="col-auto d-none d-md-block">
                <select name="size" id="pageSize" class="form-select">
                    <option value="4">4</option>
                    <option selected value="8">8</option>
                    <option value="12">12</option>
                    <option value="1000">All</option>
                </select>
            </div>
            <div class="row mt-2 mb-2">
                <div class="col-6">
                    <a href="product.html" class="btn btn-outline-secondary w-100">Clear</a>
                </div>
                <div class="col-6">
                    <button type="submit" class="btn btn-outline-info w-100">Search</button>
                </div>
            </div>
        </form>
    </div>
    <!--Product search-->

    <!--Product list view-->
    <div class="row" id="productListview">
        <div class="d-flex justify-content-center">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>
    <!--Product list view-->

    <!--Product pagination-->
    <nav class="mt-4 mb-4" aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item disabled">
                <a class="page-link" href="#" tabindex="-1" aria-disabled="true">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" id="page-1"><a class="page-link" href="?page=0&size=6">1</a></li>
            <li class="page-item" id="page-2"><a class="page-link" href="?page=1&size=6">2</a></li>
            <li class="page-item" id="page-3"><a class="page-link" href="?page=2&size=6">3</a></li>
            <li class="page-item" id="page-4"><a class="page-link" href="?page=3&size=6">4</a></li>
            <li class="page-item" id="page-5"><a class="page-link" href="?page=4&size=6">5</a></li>
            <li class="page-item" id="page-6"><a class="page-link" href="?page=5&size=6">6</a></li>
            <li class="page-item" id="page-7"><a class="page-link" href="?page=6&size=6">7</a></li>
            <li class="page-item" id="page-8"><a class="page-link" href="?page=7&size=6">8</a></li>
            <li class="page-item" id="page-9"><a class="page-link" href="?page=8&size=6">9</a></li>
            <li class="page-item" id="page-10"><a class="page-link" href="?page=9&size=6">10</a></li>
            <li class="page-item">
                <a class="page-link" href="#">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
    <!--Product pagination-->

</div>
<!--Main body-->

<!-- Footer -->
<footer class="bg-dark text-center text-white mt-5" style="background-color: #000059 !important;">
    <!-- Grid container -->
    <div class="container p-4">
        <section class="mb-4">
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Sunt distinctio earum
                repellat quaerat voluptatibus placeat nam, commodi optio pariatur est quia magnam
                eum harum corrupti dicta, aliquam sequi voluptate quas.
            </p>
        </section>
        <!-- Section: Text -->
    </div>
    <!-- Grid container -->

    <!-- Copyright -->
    <div class="text-center p-3" style="background-color: #00003f !important;">
        © <?php echo date("Y"); ?> Copyright:
        <a class=" text-white" href="#">KTN E-commerce</a>
    </div>
    <!-- Copyright -->
</footer>
<!-- Footer -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" \
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
<script defer>

    // Get param form url string
    const params = new Proxy(new URLSearchParams(window.location.search), {
        get: (searchParams, prop) => searchParams.get(prop),
    });
    console.log(params);

    // Obtain param page, size, product name, product price range
    const page = params.page;
    const size = params.size;
    const name = params.name;
    const category = params.category;
    const priceUp = params.priceUp;
    const priceLow = params.priceLow;
    const div = document.getElementById("productListview");
    console.log(name)
    console.log(category)
    console.log(priceLow)
    console.log(priceUp)

    // Fetch data base on params
    fetch('https://fakestoreapi.com/products')
        .then(res=>res.json())
        .then(products => {

            // The start index and end index are calculated based on the page and size
            const start = (!page ? 0 : page) * (!size ? 8 : size)
            const end = start + (!size ? 8 : size) * 1

            // Filter product
            const filteredProduct = products.filter(prod =>

                // Filter by name
                (!name || prod.title.includes(name)) &&

                // Filter by category
                (!category || prod.category.includes(category)) &&

                // Filter by price range
                (!priceUp || prod.price <= priceUp) &&
                (!priceLow || priceLow <= prod.price))

            // Processing pagination by slicing filtered data
            const paginatedProduct = filteredProduct.slice(start, end)
            console.log(paginatedProduct)

            // Reset product placeholder
            div.innerHTML = "";

            // Injecting product data to placeholder
            paginatedProduct.forEach(product => {
                div.innerHTML += `
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3" style="margin-top: 2%">
                        <div class="card card-shadow">
                            <img src="${product.image}" class="card-img-top card-product-image" alt="product">
                            <div class="card-body" style="background-color: aliceblue">
                                <h5 class="card-title long-and-truncated">${product.title}</h5>
                                <p class="card-text long-and-truncated">${product.description}</p>
                                <a href="./product-detail.html?id=${product.id}"
                                    style="background-color: #00003f" class="btn text-white w-100">View detail</a>
                            </div>
                        </div>
                    </div>
                `
            })
        })
</script>
</body>
</html>